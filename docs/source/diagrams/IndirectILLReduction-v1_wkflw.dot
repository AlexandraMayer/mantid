digraph IndirectILLReduction {
  label="IndirectILLReduction Flowchart"
  $global_style

  subgraph values {
    $value_style
    ScaleF [label="0.5"]
    Monitor
    Left 
    Right
    VLeft  					 
    VRight 
    MaskingRange                  
    OutputWorkspace [label="Output Workspace"]
  }

  subgraph descision {
    $decision_style   
    Save          
    HaveCalibrationWorkspace  
    UnmirrorOption
  }

  subgraph params {
  	$param_style
  	Run
  	VanadiumRun
  	MapFile
  	CalibrationWorkspace
  	Analyser
  	Reflection
  	UnmirrorOption
  }

  subgraph algorithms {
  	$algorithm_style
  	Load
  	MaskBins
    M_MaskBins [label="MaskBins"]
  	IndirectILLReduction
  	SaveNexusProcessed
    LoadParameterFile
    GroupDetectors
    ExtractSngleSpectrum
    NormaliseToMonitor
    ConvertAxisByFormula_Left [label="ConvertAxisByFormula"]
    ConvertAxisByFormula_Right [label="ConvertAxisByFormula"]
    GroupWorkspaces
    Divide
    Plus3 [label="Plus"]
    Plus4 [label="Plus"]
    Plus5 [label="Plus"]
    Plus6 [label="Plus"]
    Plus7 [label="Plus"]
    Scale
  }

  subgraph processes {
  	$process_style
  	ExtractWorkspace
    ShiftSpectra4 [label="ShiftSpectra"]
    ShiftSpectra5 [label="ShiftSpectra"]
    ShiftSpectra6 [label="ShiftSpectra"]
    ShiftSpectra7 [label="ShiftSpectra"]
  }

  Run -> Load
  Analyser -> LoadParameterFile
  Load -> LoadParameterFile
  Reflection -> LoadParameterFile
  LoadParameterFile -> ExtractSngleSpectrum 
  ExtractSngleSpectrum -> Monitor
  Monitor -> MaskingRange
  LoadParameterFile -> GroupDetectors
  MapFile -> GroupDetectors
  Monitor -> NormaliseToMonitor
  GroupDetectors -> NormaliseToMonitor
  NormaliseToMonitor -> M_MaskBins
  MaskingRange -> M_MaskBins
  M_MaskBins -> HaveCalibrationWorkspace
  HaveCalibrationWorkspace -> ExtractWorkspace [label="No"]
  HaveCalibrationWorkspace -> Divide [label="Yes"]
  CalibrationWorkspace -> Divide
  Divide -> ExtractWorkspace
  ExtractWorkspace -> ConvertAxisByFormula_Left [label="Left"]
  ExtractWorkspace -> ConvertAxisByFormula_Right [label="Right"]
  ConvertAxisByFormula_Left -> Left
  ConvertAxisByFormula_Right -> Right
  Left -> UnmirrorOption
  Right -> UnmirrorOption
  VanadiumRun -> IndirectILLReduction
  IndirectILLReduction -> VLeft
  IndirectILLReduction -> VRight
  VLeft -> UnmirrorOption
  VRight -> UnmirrorOption
  UnmirrorOption -> Plus3 [label="3"]
  Left -> Plus3
  Right -> Plus3 
  UnmirrorOption -> ShiftSpectra4 [label="4"]
  Right -> ShiftSpectra4
  Left -> ShiftSpectra4
  ShiftSpectra4 -> Plus4 [label="Right Shifted"]
  Left -> Plus4
  UnmirrorOption -> ShiftSpectra5 [label="5"]
  ShiftSpectra5 -> Plus5 [label="Right Shifted"]
  Right -> ShiftSpectra5
  VRight -> ShiftSpectra5
  Left -> Plus5
  UnmirrorOption -> ShiftSpectra6 [label="6"]
  Left -> ShiftSpectra6
  Right -> ShiftSpectra6
  ShiftSpectra6 -> Plus6 [label="Left Shifted"]
  ShiftSpectra6 -> Plus6 [label="Right Shifted"]
  UnmirrorOption -> ShiftSpectra7 [label="7"]
  Left -> ShiftSpectra7
  Right -> ShiftSpectra7
  VLeft -> ShiftSpectra7
  VRight -> ShiftSpectra7
  ShiftSpectra7 -> Plus7 [label="Left Shifted"]
  ShiftSpectra7 -> Plus7 [label="Right Shifted"]
  ScaleF -> Scale
  Plus3 -> Scale
  Plus4 -> Scale 
  Plus5 -> Scale
  Plus6 -> Scale
  Plus7 -> Scale
  Scale -> MaskBins
  MaskBins -> GroupWorkspaces
  GroupWorkspaces -> OutputWorkspace
  OutputWorkspace -> Save
  Save -> SaveNexusProcessed [label="Yes"]

}