digraph IndirectILLReduction {
  label="IndirectILLReduction Flowchart"
  $global_style

  subgraph values {
    $value_style
    ScaleF [label="0.5"]
    Monitor
    Left 
    Right
    VLeft  					 
    VRight 
    MaskingRange                  
    OutputWorkspace [label="Output Workspace"]
  }

  subgraph descision {
    $decision_style   
    Save          
    HaveCalibrationWorkspace
    HaveBackgroundRun
    UnmirrorOption
  }

  subgraph params {
  	$param_style
  	Run
  	VanadiumRun
  	MapFile
  	CalibrationWorkspace
  	BackgroundRun
  	Analyser
  	Reflection
  	UnmirrorOption
  }

  subgraph algorithms {
  	$algorithm_style
  	Load
  	MaskBins
    M_MaskBins [label="MaskBins"]
  	IndirectILLReduction
  	SaveNexusProcessed
    LoadParameterFile
    GroupDetectors
    ExtractSngleSpectrum
    NormaliseToMonitor
    ConvertAxisByFormula_Left [label="ConvertAxisByFormula"]
    ConvertAxisByFormula_Right [label="ConvertAxisByFormula"]
    GroupWorkspaces
    Divide
    Plus
    Scale
    Minus
  }

  subgraph processes {
  	$process_style
  	ExtractWorkspace
    ShiftSpectra
  }

  Run -> Load
  Analyser -> LoadParameterFile
  Load -> LoadParameterFile
  Reflection -> LoadParameterFile
  LoadParameterFile -> ExtractSngleSpectrum 
  ExtractSngleSpectrum -> Monitor
  Monitor -> MaskingRange
  LoadParameterFile -> GroupDetectors
  MapFile -> GroupDetectors
  Monitor -> NormaliseToMonitor
  GroupDetectors -> NormaliseToMonitor
  NormaliseToMonitor -> M_MaskBins
  MaskingRange -> M_MaskBins
  M_MaskBins -> HaveBackgroundRun
  HaveBackgroundRun -> Minus [label="Yes"]
  HaveBackgroundRun -> HaveCalibrationWorkspace [label="No"]
  BackgroundRun -> HaveBackgroundRun
  Minus -> HaveCalibrationWorkspace
  HaveCalibrationWorkspace -> ExtractWorkspace [label="No"]
  HaveCalibrationWorkspace -> Divide [label="Yes"]
  CalibrationWorkspace -> Divide
  Divide -> ExtractWorkspace
  ExtractWorkspace -> ConvertAxisByFormula_Left [label="Left"]
  ExtractWorkspace -> ConvertAxisByFormula_Right [label="Right"]
  ConvertAxisByFormula_Left -> Left
  ConvertAxisByFormula_Right -> Right
  UnmirrorOption -> ShiftSpectra
  Left -> ShiftSpectra
  Right -> ShiftSpectra
  VanadiumRun -> IndirectILLReduction
  IndirectILLReduction -> VLeft
  IndirectILLReduction -> VRight
  VLeft -> ShiftSpectra
  VRight -> ShiftSpectra
  ShiftSpectra -> Plus
  Plus -> Scale
  ScaleF -> Scale
  Scale -> MaskBins
  MaskBins -> GroupWorkspaces
  GroupWorkspaces -> OutputWorkspace
  OutputWorkspace -> Save
  Save -> SaveNexusProcessed [label="Yes"]

}