#ifndef MANTIDQTCUSTOMINTERFACES_EXCITATIONS_H_
#define MANTIDQTCUSTOMINTERFACES_EXCITATIONS_H_

#include "MantidQtCustomInterfaces/ui_Excitations.h"
#include "MantidQtCustomInterfaces/pythonCalc.h"
#include "MantidKernel/PropertyWithValue.h"
#include "MantidQtAPI/UserSubWindow.h"
#include "MantidAPI/IAlgorithm.h"
#include <QString>
#include <QHash>

namespace MantidQt
{
namespace CustomInterfaces
{
class Excitations : public MantidQt::API::UserSubWindow
{
  Q_OBJECT

public:
  /// there has to be a default constructor but you can call it with a pointer to the thing that will take ownership of it
  Excitations(QWidget *parent = 0);

private:
  /// number of extensions for input files allowed
  static const int numInputExts= 4;
  /// a list of the extensions for input files allowed
  static const std::string inputExts[numInputExts];
  /// The form generated by Qt Designer
  Ui::Excitations m_uiForm;
  // structures to hold the values entered by the use
  /// Pointers to instances of all the algorithms used. From these the properties are taken and used for validation
  std::vector<Mantid::API::IAlgorithm_sptr> m_algorDummies;
  /// caches the value of the 
  bool m_saveChanged;
  deltaECalc::FileInput *m_inFiles;

    /// Initialize the layout
  virtual void initLayout();
  bool parseInput();
  void clearData();
  void readTheDialog();
  void readFile(const QString &pythonFile, QString &scriptText) const;
  pythonCalc::TestSummary readRes(QString pyhtonOut);
  /// enable the run button if the results dialog has been closed and the python has stopped
  void pythonIsRunning(bool running);
  QString defaultName();
  std::string insertNumber(const std::string &filename, const int number);

  void setUpPage1();
  void setUpPage2();
  void setUpPage3();

private slots:
  ///run the algorithms that can be run with the data that users supplied
  void run();
  //get rid of this one, no?
  void browseClicked(const QString &buttonDis);
  void addRunFile();
  /// open the wiki page for this interface in their browser
  void helpClicked();
  void disenableAbsolute();
  void disenableDiag();
  void updateSaveName();
  void saveNameUpd();
  void normalise(const QString &newText);

protected:
  void saveInput();
};
}
}

#endif //MANTIDQTCUSTOMINTERFACES_EXCITATIONS_H_