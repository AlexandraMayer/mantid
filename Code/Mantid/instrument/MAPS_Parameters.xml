<?xml version="1.0" encoding="UTF-8" ?>
<parameter-file instrument = "MAPS" date = "2013-06-12T00:00:00">

<component-link name = "MAPS">

<!-- files properties : -->

<!-- Specify that the detector positions should be taken from the data file -->
<parameter name="det-pos-source" type="string">
  <value val="datafile"/>
</parameter>
<!-- The file which defines proper (calibrated) detector positions 
     if None - it is undefined -->
<parameter name="det_cal_file" type="string">
   <value val="None"/>
</parameter>
<!-- The file which defines detectors to spectra mapping;
     if None - one2one map is used  -->
<parameter name="map_file" type="string">
   <value val="4to1.map"/>
</parameter>

<!-- Extension of the data files obtained from DAE -->
<parameter name="data_file_ext" type="string">
   <value val=".RAW"/>
</parameter>
<!-- The name of the hard mask file to use together with diag masking -->
<parameter name="hard_mask_file" type="string">
    <value val="4to1_124mod.msk"/>
</parameter>
<!-- The if true, use only hard mask file specified above and do not run diagnostics procedures -->
<parameter name="use_hard_mask_only" type="bool">
    <value val="False"/>
</parameter>



<!-- RunNumber to use for diag instead of the input run number if none - use input run -->
<parameter name="mask_run" type="string">
   <value val="None"/>
</parameter>

<!-- Energy conversion mode direct/indirect/elastic (the one the reducer understands) -->
<parameter name="deltaE-mode" type="string">
  <value val="direct"/>
</parameter>

<!-- Monitor used to estimate total current on the sample.  -->
<parameter name="norm-mon1-spec">
  <value val="41473"/>
</parameter>
<!-- Time interval used for integration to estimate current on the sample 
    This interval is usually taken around the monitor peak-->
<parameter name="norm-mon1-min">
  <value val="1000"/>
</parameter>
<parameter name="norm-mon1-max">
  <value val="2000"/>
</parameter>
<parameter name="norm_mon_integration_range"  type="string">
  <value val="norm-mon1-min:norm-mon1-max"/>
</parameter>


<!-- First spectra number (monitor number) to use when measuring incident energy
    Should be spectra with well defined energy peak -->
<parameter name="ei-mon1-spec"  type="int">
  <value val="41474"/>
</parameter>
<!-- Second spectra number (monitor number) to use when measuring incident energy
     Should be spectra with well defined energy peak -->
<parameter name="ei-mon2-spec"  type="int">
  <value val="41475"/>
</parameter>
<parameter name="ei_mon_spectra"  type="string">
  <value val="ei-mon1-spec:ei-mon2-spec"/>
</parameter>



<parameter name="scale-factor">
  <value val="1.7016e8"/>
</parameter>

<parameter name="wb-scale-factor">
  <value val="1000"/>
</parameter>

<!-- integration range for background tests (in TOF) - composite property -->
<parameter name="bkgd-range-min"> 
  <value val="15000"/>
</parameter>
<parameter name="bkgd-range-max">
  <value val="19000"/>
</parameter>
<parameter name="background_range"  type="string">
      <value val="bkgd-range-min:bkgd-range-max"/>
</parameter>
<!-- Remove the count rate seen in the regions of the histograms defined as the background regions -->
<parameter name="background"  type="bool">
   <value val="False"/>
</parameter>
<!-- True if background is to be checked UNUSED PROPERTY !!! -->
<parameter name="check_background"  type="bool">
  <value val="True"/>
</parameter>



<!--  detector_van_range- integratin in E(mev) for detector vanadium data [20,100] -->
<parameter name="wb-integr-min">
  <value val="20"/>
</parameter>
<parameter name="wb-integr-max">
  <value val="100"/>
</parameter>
<parameter name="wb_integr_range"   type="string">
    <value val="wb-integr-min:wb-integr-max"/>
</parameter>




<parameter name="monovan-integr-min">
  <value val="-1"/>
</parameter>
<parameter name="monovan-integr-max">
  <value val="1"/>
</parameter>
<parameter name="monovan_integr_range"  type="string">
    <value val="monovan-integr-min:monovan-integr-max"/>
</parameter>



<parameter name="vanadium-mass">
  <value val="30.1"/>
</parameter>

<!-- ******************************** DIAGNOSTICS DEFAILTS **************************************** -->

<!-- Perform diag by bank. These are the spectrum numbers -->
<parameter name="diag_spectra" type="string">
  <value val="(1,17280);(17281,18432);(18433,32256);(32257,41472)"/>
</parameter>

<!-- Absolute lo threshold for vanadium diag (tiny) -->
<parameter name="diag_tiny">
  <value val="1e-10"/>
</parameter>

<!-- Absolute hi threshold for vanadium diag (large) -->
<parameter name="diag_huge">
  <value val="1e10"/>
</parameter>

<!-- Setting diag to reject zero backgrounds; If true then zeroes in (vanadium) data are masked as fail  -->
<parameter name="diag_samp_zero"  type="bool">
  <value val="False"/>
</parameter>

<!-- Fraction of median to consider counting low for the white beam diag (diag_van_median_rate_limit_hi sv_lo)-->
<parameter name="diag_samp_lo">
  <value val="0.0"/>
</parameter>
<!-- Fraction of median to consider counting high for the white beam diag (sv_hi)-->
<parameter name="diag_samp_hi">
  <value val="1.5"/>
</parameter>

<!-- Error criterion as a multiple of error bar for background (sv_sig) 
  i.e. to fail the test, the magnitude of the
  difference with respect to the median value must also exceed this number of error bars (default=3.3)
-->  
<parameter name="diag_samp_sig">
  <value val="3.3"/>
</parameter>

<!-- Lower bound defining outliers as fraction of median value (v_out_lo)-->
<parameter name="diag_van_out_lo">
  <value val="0.01"/>
</parameter>

<!-- Upper bound defining outliers as fraction of median value (v_out_hi) -->
<parameter name="diag_van_out_hi">
  <value val="100."/>
</parameter>

<!-- Fraction of median to consider counting low for the white beam diag (vv_lo)  vanlo=0.1  -->
<parameter name="diag_van_lo">
  <value val="0.01"/>
</parameter>

<!-- Fraction of median to consider counting high for the white beam diag (vv_hi) vanhi=1.5 -->
<parameter name="diag_van_hi">
  <value val="2.0"/>
</parameter>

<!-- Error criterion as a multiple of error bar     van_sig  "
    i.e. to fail the test, the magnitude of the difference with respect to the median value must also exceed this number of error bars (default=0.0)
-->
<parameter name="diag_van_sig">
  <value val="0.0"/>
</parameter>

<!-- Variation for ratio test with second white beam -->
<parameter name="diag_variation">
  <value val="1.1"/>
</parameter>

<!-- **************************************** DIAGNOSTICS DEFAILTS END ****************************************    -->
<!--  -->

<!-- Absolute units conversion average -->
<parameter name="monovan_lo_bound">
  <value val="0.01"/>
</parameter>

<parameter name="monovan_hi_bound">
  <value val="100"/>
</parameter>

<parameter name="monovan_lo_frac">
  <value val="0.8"/>
</parameter>
<parameter name="monovan_lo_value">
  <value val="-40."/>
</parameter>


<parameter name="monovan_hi_frac">
  <value val="1.2"/>
</parameter>
<parameter name="monovan_hi_value">
  <value val="40."/>
</parameter>

<!-- energy range for integration calculating absolute units correction vanadium data 
     if None, range is calculated from monovan_hi_frac/monovan_lo_frac 
     - providing the fractions of the incident energy      
     if one wants to specify the energy values here it has to be defined in the form:
    <value val="monovan_lo_value,monovan_hi_value"/>     
 -->    
<parameter name="abs_units_van_range"  type="string">
  <value val="None"/>
</parameter>

<!--  -->
<!--  Bleeding corrections   -->

<!--  the number of pixels ignored within the bleed test diagnostic -->
<parameter name="bleed_pixels">
    <value val="0"/>
</parameter>
<!--  the maximum framerate allowed in a tube -->
<parameter name="bleed_maxrate">
    <value val="0"/>
</parameter>
<!-- True if the bleed tests should be run use_bleeding-->
<parameter name="diag_bleed_test"  type="bool">
    <value val="False"/>
</parameter>


<!-- normalise_method normalistion. Availible values are: monitor-1,monitor-2, uamph current -->
<parameter name="normalise_method" type="string">
    <value val="monitor-1"/>
</parameter>

<!-- if defined to true, fix incident energy to this value and do not calculate the energy from the run -->
<parameter name="fixei"  type="bool">
    <value val="False"/>
</parameter>

<!-- The format of output data. Three values are currently supported, namely spe, nxspe, and nexus (mantid workspace) 
     Unlike anything else, three possible v values are defined in DirectEnergy conversion. 
     If None is there, no internal script saving occurs-->  
<parameter name="save_format" type="string">
   <value val=".nxspe"/>
</parameter>

<!-- If one wants to sum runs   -->  
<parameter name="sum_runs"  type="bool">
   <value val="False"/>
</parameter>

<!-- # Run Detector Efficiency Correction -->
<parameter name="apply_detector_eff"  type="bool">
   <value val="True"/>
</parameter>

<!-- List of the words which can be used as a command line arguments to define reducer keywords
     the form is reducer_keword1=synonim1=synonim2=synonim3;reducer_keword1=synonim1a, so, 
     the reducer keywords are the leftmost values of the keyword assignements below
     Each keyword met in command line or file above are converted into reducer keyword as below
-->  
<parameter name="synonims" type="string">
   <value val="normalise_method=norm_method;
       fix_ei=fixei;
       sum_runs=sum;
       wb_integr_range=detector_van_range;
       van_mass=vanadium-mass;
       background_range=bkgd_range;
       mon1_norm_spec=norm-mon1-spec;
       scale_factor=scale-factor;
       wb_scale_factor=wb-scale-factor;
       monovan_integr_range=abs_units_van_range;
       hard_mask_file=hardmaskPlus;
       use_hard_mask_only=hardmaskOnly;
       van_out_lo = diag_van_median_rate_limit_lo=diag_van_out_lo;
       van_out_hi = diag_van_median_rate_limit_hi=diag_van_out_hi;
       van_lo     = diag_van_median_sigma_lo=diag_van_lo;
       van_hi     = diag_van_median_sigma_hi=diag_van_hi;
       van_sig    = diag_van_median_sigma=diag_van_sig;
       tiny       = diag_tiny;
       huge       = diag_huge=large;
       samp_zero  = diag_remove_zero=diag_samp_zero;
       samp_lo    = diag_samp_median_sigma_lo=diag_samp_lo;
       samp_hi    = diag_samp_median_sigma_hi=diag_samp_hi;
       samp_sig   = diag_samp_median_sigma=diag_samp_sig;
       variation  = diag_variation;
       bleed_test=bleed=diag_bleed_test;
       ei-mon2-spec = test_ei2_mon_spectra;
       ei_mon_spectra=test_mon_spectra_composite"
    />
</parameter>
 
  <!-- -->
</component-link>

</parameter-file>
