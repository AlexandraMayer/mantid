#ifndef MANTIDQTCUSTOMINTERFACES_DYNAMICPDF_SLICESELECTOR_H_
#define MANTIDQTCUSTOMINTERFACES_DYNAMICPDF_SLICESELECTOR_H_

//Mantid Coding standars <http://www.mantidproject.org/Coding_Standards>
//Mantid Headers from the same project
#include "ui_SliceSelector.h"
//Mantid headers from other projects
#include "MantidAPI/MatrixWorkspace.h"
// includes for interface
#include "MantidQtCustomInterfaces/DllConfig.h"
#include "MantidQtAPI/UserSubWindow.h"

//3rd party library headers
#include <qwt_plot_spectrogram.h>

// Forward Declarations
namespace MantidQt {
namespace MantidWidgets {
  class MWView;
  class RangeSelector;
}
}

namespace MantidQt {
namespace CustomInterfaces {
namespace DynamicPDF {

/// Helper class containing pointer and some metadata for the loaded workspace
class WorkspaceRecord{

public:
  WorkspaceRecord(const std::string &workspaceName);
  void updateMetadata(const size_t &newIndex);
  std::pair<double,double> getErange();

  boost::shared_ptr<Mantid::API::MatrixWorkspace> m_ws;
  const std::string m_name;
  double m_energy;
  std::string m_label;
};

class MANTIDQT_CUSTOMINTERFACES_DLL SliceSelector
    : public MantidQt::API::UserSubWindow {
  Q_OBJECT

public:
  /// The name of the interface as registered into the factory
  static std::string name() { return "Dynamic PDF Slice Selector"; }
  // This interface's categories.
  static QString categoryInfo() { return "DynamicPDF"; }

public:
  SliceSelector(QWidget *parent = nullptr);
  ~SliceSelector() override;

private slots:
  void showHelp();
  void loadSlices(const QString &workspaceName);
  void updateSelectedSlice(const int &newSelectedIndex);
  void newIndexFromPickedEnergy(const double &newEnergySelected);
  void updatePreviewPlotSelectedSlice();
  void updatePickerLine();
  void updatePlotSelectedSlice();
  void selectSliceForFitting();

private:
  void initLayout() override;
  void spawnPickerLine();
  void initPickerLine();
  bool isWorkspaceValid();

  /// The form generated by Qt Designer
  Ui::SliceSelector m_uiForm;
  /// line that selects a slice in the 2D view
  MantidWidgets::RangeSelector *m_pickerLine;
  boost::shared_ptr<WorkspaceRecord> m_loadedWorkspace;
  size_t m_selectedWorkspaceIndex;

}; //class SliceSelector

}
}
}
#endif //MANTIDQTCUSTOMINTERFACES_DYNAMICPDF_SLICESELECTOR_H_
